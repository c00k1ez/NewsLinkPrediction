## Суть задачи

Есть датасет, состоящий из расшифровки речи комментатора матча и списка новостей, связанных с этим матчем. Задача - **предсказать наличие связи между расшифровкой (далее бродкастом) и новостью.** 

* Все подробности именно research части можно посмотреть [тут](https://www.notion.so/Research-plan-50a8dc2c4a9e4931af5bf206b33ff398).

* Менеджмент экспериментов ведется в comet.ml.

## Описание конфигов

Т.к в этом проекте я решил отказаться от полотен argparse агрументов, то имеет смысл более подробно расписать, какие параметры поддерживаются в конфигах.

Прежде всего, все конфиги лежат в папке `configs`.

Файлы, лежащие в `./configs/*` - постоянные для всех экспериментов, чтобы не таскать за собой одно и то же из конфига в конфиг.

В `./configs/experiments/*` лежат именно конфиги для экспериментов. Параметры, записанные в них, имеют наивысший приоритет, т.е в случае конфликта с параметром из `./configs/*`, он будет перезаписан из эксперимента (пока не реализовано).

`trainer.yaml`:

Любые параметры для `pytorch_lightning.Trainer`.

`tokenizer.yaml`:

**model_name** - имя модели из `transformers` (если она используется).

**tokenizer/module_name** - название модуля, из которого берется токенайзер (например, может быть `src.bpe_tokenizer`,  т.к там есть реализация токенайзера на YTTM).

**tokenizer/class_name** - Имя самого класса токенайзера.

`data.yaml`:

**data_path** - путь до папки с данными.

**datasets/*** - параметры для датасета.

**loaders/*** - параметры для даталоадера.

`experiments/baseline_*_model.yaml`:

**experiment_name** - имя эксперимента для логгирования.

**backbone_model** - класс модели-енкодера
**freeze_backbone** - замораживать ли енкодер.
**main_model** - основная модель, класс из `src.models`.
**model_output_prob** - возвращает ли модель пары векторов или сразу расстояние, пока не используется.
**cos_margin** - марджин для косинусного расстояния между векторами бродкаста и новости. Если расстояние больше марджина, значит связь есть, иначе - нет.

**model/*** - параметры для модели.

**criterion_name** - класс лосс функции из `src.losses`.

**criterion/*** - необязательный параметр, параметры для инициализации лосса.

**optimizer/*** - параметры для оптимизатора. Используется `transformers.AdamW`.